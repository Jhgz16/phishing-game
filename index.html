<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Phishing Awareness Quiz</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    #message-body a {
      color: blue;
      text-decoration: underline;
    }
  </style>
</head>
<body class="bg-gray-100 font-sans">
  <div class="container mx-auto p-4 max-w-4xl">
    <!-- Header -->
    <header class="text-center mb-8">
      <h1 class="text-3xl font-bold text-gray-800">Phishing Awareness Quiz</h1>
      <p class="text-gray-600 mt-2">Test your ability to spot phishing emails and SMS. Can you identify the scams?</p>
    </header>

    <!-- Progress Tracker -->
    <div class="mb-6">
      <div class="flex justify-between items-center">
        <p class="text-gray-700">Question <span id="current-question">1</span> of <span id="total-questions">10</span></p>
        <p class="text-gray-700">Score: <span id="score">0</span></p>
      </div>
      <div class="w-full bg-gray-200 rounded-full h-2.5 mt-2">
        <div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full" style="width: 10%"></div>
      </div>
    </div>

    <!-- Quiz Container -->
    <div id="quiz-container" class="bg-white shadow-lg rounded-lg p-6">
      <!-- Message Display -->
      <div id="message-display" class="border border-gray-300 rounded-lg p-4 mb-4">
        <div id="message-header" class="flex justify-between items-center mb-2">
          <span id="sender" class="font-semibold"></span>
        </div>
        <p id="subject" class="font-medium mb-2"></p>
        <div id="message-body" class="text-gray-700"></div>
      </div>

      <!-- Answer Buttons -->
      <div class="flex justify-center space-x-4">
        <button id="legitimate-btn" class="bg-green-500 text-white px-6 py-2 rounded hover:bg-green-600">Legitimate</button>
        <button id="phishing-btn" class="bg-red-500 text-white px-6 py-2 rounded hover:bg-red-600">Phishing</button>
      </div>
    </div>

    <!-- Feedback Modal -->
    <div id="feedback-modal" class="hidden fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center">
      <div class="bg-white rounded-lg p-6 max-w-lg w-full">
        <h2 id="feedback-title" class="text-xl font-bold mb-4"></h2>
        <p id="feedback-message" class="text-gray-700 mb-4"></p>
        <button id="next-btn" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Next</button>
      </div>
    </div>

    <!-- Results Screen -->
    <div id="results-container" class="hidden bg-white shadow-lg rounded-lg p-6">
      <h2 class="text-2xl font-bold text-gray-800 mb-4">Quiz Complete!</h2>
      <p class="text-gray-700 mb-4">Your final score: <span id="final-score"></span> out of 10</p>
      <p id="results-message" class="text-gray-700 mb-4"></p>
      <button id="restart-btn" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Restart Quiz</button>
    </div>
  </div>

  <script src="questions.js"></script>
  <script>
    let currentQuestion = 0;
    let score = 0;
    const totalQuestions = 10;

    // Shuffle array helper
    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    // Select 10 questions: 6 Phishing, 4 Legitimate
    function getRandomQuestions() {
      // Filter questions by type
      const phishingQuestions = questions.filter(q => q.isPhishing);
      const legitimateQuestions = questions.filter(q => !q.isPhishing);

      // Select 6 phishing questions
      const phishingSelection = shuffle([...phishingQuestions]).slice(0, 6);

      // Select 4 legitimate questions
      const legitimateSelection = shuffle([...legitimateQuestions]).slice(0, 4);

      // Combine and shuffle all selected questions
      const selectedQuestions = [
        ...phishingSelection,
        ...legitimateSelection
      ];

      return shuffle(selectedQuestions);
    }

    let currentQuestions = getRandomQuestions();

    // URL Hover Display
    const urlDisplay = document.createElement('div');
    urlDisplay.id = 'url-display';
    urlDisplay.className = 'absolute bg-gray-800 text-white text-sm px-2 py-1 rounded hidden';
    document.body.appendChild(urlDisplay);

    function showURL(url) {
      urlDisplay.textContent = url;
      urlDisplay.classList.remove('hidden');
      urlDisplay.style.top = `${event.pageY + 10}px`;
      urlDisplay.style.left = `${event.pageX + 10}px`;
    }

    function hideURL() {
      urlDisplay.classList.add('hidden');
    }

    function loadQuestion() {
      const question = currentQuestions[currentQuestion];
      document.getElementById('current-question').textContent = currentQuestion + 1;
      document.getElementById('total-questions').textContent = totalQuestions;
      document.getElementById('sender').textContent = question.sender;
      document.getElementById('subject').textContent = question.subject;
      document.getElementById('message-body').innerHTML = question.body;
      document.getElementById('progress-bar').style.width = `${((currentQuestion + 1) / totalQuestions) * 100}%`;

      // Adjust styling for SMS vs Email
      const messageDisplay = document.getElementById('message-display');
      if (question.type === 'sms') {
        messageDisplay.classList.add('max-w-md', 'mx-auto', 'bg-gray-50', 'border-2', 'border-gray-400');
        messageDisplay.classList.remove('border-gray-300');
      } else {
        messageDisplay.classList.remove('max-w-md', 'mx-auto', 'bg-gray-50', 'border-2', 'border-gray-400');
        messageDisplay.classList.add('border-gray-300');
      }
    }

    function showFeedback(isCorrect, feedback) {
      const modal = document.getElementById('feedback-modal');
      const title = document.getElementById('feedback-title');
      const message = document.getElementById('feedback-message');
      title.textContent = isCorrect ? 'Correct!' : 'Incorrect';
      title.className = isCorrect ? 'text-green-600' : 'text-red-600';
      message.textContent = feedback;
      modal.classList.remove('hidden');
    }

    function showResults() {
      document.getElementById('quiz-container').classList.add('hidden');
      document.getElementById('results-container').classList.remove('hidden');
      document.getElementById('final-score').textContent = score;
      const resultsMessage = document.getElementById('results-message');
      if (score >= 8) {
        resultsMessage.textContent = 'Excellent job! Youâ€™re well-equipped to spot phishing attempts. Keep practicing to stay sharp.';
      } else if (score >= 5) {
        resultsMessage.textContent = 'Good effort! You caught some phishing attempts, but review the feedback to improve your skills.';
      } else {
        resultsMessage.textContent = 'Needs improvement. Phishing attacks are tricky! Retake the quiz and focus on the feedback to learn common red flags.';
      }
    }

    // Event Listeners
    document.getElementById('legitimate-btn').addEventListener('click', () => {
      const question = currentQuestions[currentQuestion];
      const isCorrect = !question.isPhishing;
      if (isCorrect) score++;
      document.getElementById('score').textContent = score;
      showFeedback(isCorrect, question.feedback);
    });

    document.getElementById('phishing-btn').addEventListener('click', () => {
      const question = currentQuestions[currentQuestion];
      const isCorrect = question.isPhishing;
      if (isCorrect) score++;
      document.getElementById('score').textContent = score;
      showFeedback(isCorrect, question.feedback);
    });

    document.getElementById('next-btn').addEventListener('click', () => {
      document.getElementById('feedback-modal').classList.add('hidden');
      currentQuestion++;
      if (currentQuestion < totalQuestions) {
        loadQuestion();
      } else {
        showResults();
      }
    });

    document.getElementById('restart-btn').addEventListener('click', () => {
      currentQuestion = 0;
      score = 0;
      document.getElementById('score').textContent = score;
      document.getElementById('quiz-container').classList.remove('hidden');
      document.getElementById('results-container').classList.add('hidden');
      currentQuestions = getRandomQuestions();
      loadQuestion();
    });

    // Initialize Quiz
    loadQuestion();
  </script>
</body>
</html>
